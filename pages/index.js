import React from 'react';
import Head from 'next/head';
import Image from 'next/image';
import Banner from '../components/Banner';
import Navbar from '../components/Navbar';
import Text from '../components/Text';
import { light2, site } from '../styles/js-colors';
import styles from '../styles/Home.module.scss';
import Header from '../components/Header';
import Container from '../components/Container';
import Button from '../components/Button';
import { axiosAirTable } from '../public/Axios';
import PhotoGrid from '../components/PhotoGrid';
import usePhotoGrid from '../hooks/usePhotoGrid';

export default function Home({ paintings, homePageConfig }) {
  const { fields } = homePageConfig;
  const { isOpen, handleIsOpen } = usePhotoGrid();
  const colorText = fields['Text Color'] === 'dark' ? site : light2;

  return (
    <div className={styles.Home}>
      <Head>
        <title>Clive Roberts</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>

      <Navbar />
      <Banner>
        <Container classnames={styles.BannerContainer}>
          <Text color={colorText} fontSize={28} classnames={styles.BannerText}>
            {fields['Description']}
          </Text>
          <Button classnames={styles.BannerButton} href="/about">
            Learn More
          </Button>
        </Container>
      </Banner>
      <Container variant="center">
        <Header fontSize={36}>Featured Work</Header>
      </Container>
      <Container style={{ padding: '20px 10px' }}>
        <PhotoGrid images={paintings.slice(0, 3)} isOpen={isOpen} handleIsOpen={handleIsOpen} />
      </Container>
      <Container variant="center">
        <Button variant="primary" href="/portfolio">
          My Portfolio
        </Button>
      </Container>
    </div>
  );
}

export async function getServerSideProps(context) {
  const paintings = await axiosAirTable
    .get('/appX2ycFLtWmCcHVb/Paintings')
    .then((res) => res.data.records);

  const homePageConfig = await axiosAirTable
    .get('/appX2ycFLtWmCcHVb/HomePage/recCZFdkzNBUyVbX7')
    .then((res) => res.data);

  console.log(homePageConfig);

  return {
    props: {
      paintings,
      homePageConfig,
    },
  };
}
